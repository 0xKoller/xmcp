---
title: "First Tool"
metadataTitle: "xmcp - First Tool | Documentation"
publishedAt: "2025-07-4"
summary: "Lorem ipsum"
---

# Writing Your First Tool

This guide walks you through creating a custom weather tool that demonstrates the key concepts of schema validation, API integration, and error handling in xmcp.

## Prerequisites

Before starting, you'll need an xmcp project set up and a free API key from OpenWeatherMap. Sign up at their website, generate an API key, and add it to your `.env` file as `WEATHER_API_KEY=your-api-key-here`.

## Creating the Tool File

Create a new file `src/tools/weather.ts` and start with the basic structure. Every tool needs three exports: a schema for parameter validation, metadata for tool information, and a default function that implements the logic.

```ts
import { z } from "zod";
import { type InferSchema } from "xmcp";

export const schema = {
  location: z
    .string()
    .min(1, "Location is required")
    .describe("City name or coordinates"),

  units: z
    .enum(["metric", "imperial"])
    .default("metric")
    .describe("Temperature units: metric (째C) or imperial (째F)"),
};

export const metadata = {
  name: "get_weather",
  description: "Get current weather information for any location",
  annotations: {
    title: "Weather Information",
    readOnlyHint: true,
    destructiveHint: false,
    idempotentHint: true,
  },
};

export default async function weather({
  location,
  units,
}: InferSchema<typeof schema>) {
  // Implementation goes here
}
```

## Implementing the Tool Logic

The tool implementation fetches weather data from the OpenWeatherMap API and returns it in MCP format. Start by checking for the API key, then make the HTTP request, and handle both success and error cases appropriately.

```ts
export default async function weather({
  location,
  units,
}: InferSchema<typeof schema>) {
  const apiKey = process.env.WEATHER_API_KEY;

  if (!apiKey) {
    return {
      content: [
        {
          type: "text",
          text: "Error: Weather API key not configured. Please set WEATHER_API_KEY environment variable.",
        },
      ],
    };
  }

  try {
    const url = `https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(location)}&units=${units}&appid=${apiKey}`;
    const response = await fetch(url);

    if (!response.ok) {
      if (response.status === 404) {
        throw new Error(`Location "${location}" not found`);
      }
      throw new Error(`Weather API error: ${response.status}`);
    }

    const data = await response.json();
    const temp = Math.round(data.main.temp);
    const unitSymbol = units === "metric" ? "째C" : "째F";

    return {
      content: [
        {
          type: "text",
          text: `Weather in ${data.name}, ${data.sys.country}: ${temp}${unitSymbol}, ${data.weather[0].description}. Humidity: ${data.main.humidity}%, Wind: ${data.wind.speed} m/s`,
        },
      ],
    };
  } catch (error) {
    return {
      content: [
        {
          type: "text",
          text: `Error fetching weather data: ${error.message}`,
        },
      ],
    };
  }
}
```

## Testing Your Tool

Start the development server with `npm run dev` and you should see your weather tool discovered alongside the existing add tool. Test it by making a POST request to your HTTP endpoint with the tool name and required parameters.

```bash
curl -X POST http://localhost:3002/mcp \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "id": 1,
    "method": "tools/call",
    "params": {
      "name": "get_weather",
      "arguments": {
        "location": "London",
        "units": "metric"
      }
    }
  }'
```

The response will include the current weather information formatted as text content within the MCP response structure. If you encounter errors, check that your API key is correctly set and that the location name is valid.

## Understanding the Implementation

The schema definition uses Zod to validate parameters, ensuring the location is a non-empty string and units is one of the allowed values with a default. The metadata provides essential information for the MCP system, including behavioral hints that help AI models understand how to use the tool effectively.

The tool function handles the API key check, constructs the proper URL with encoded parameters, makes the HTTP request, and processes the response. Error handling covers both API errors and network issues, providing meaningful error messages that help users understand what went wrong.

## Next Steps

You've successfully created a functional weather tool that demonstrates the core concepts of xmcp development. This foundation prepares you to build more complex tools that integrate with databases, perform file operations, or interact with other external services.

_Excellent work! You're now ready to explore more advanced xmcp features and build sophisticated MCP applications._
